<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AS5047: AS5047 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AS5047
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('class_a_s5047.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="class_a_s5047-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">AS5047 Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>More informations at : <a href="https://ams.com/en/ams-start">https://ams.com/en/ams-start</a>.  
 <a href="class_a_s5047.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_a_s5047_8h_source.html">AS5047.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a404f74b69362df86e4a2509c4600d399"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399">T_AS5047_Rotation</a> { <a class="el" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399afb41fbae1a0e478416cb6ca7e7d42894">CW_increasing</a> = 0
, <a class="el" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399a87b06a79ccea20d744ca45444038baac">CCW_decreasing</a> = 1
 }</td></tr>
<tr class="memdesc:a404f74b69362df86e4a2509c4600d399"><td class="mdescLeft">&#160;</td><td class="mdescRight">Explicit information list :  <a href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399">More...</a><br /></td></tr>
<tr class="separator:a404f74b69362df86e4a2509c4600d399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b570058188a424a4b4384391bad4fa7"><td class="memItemLeft" align="right" valign="top">typedef short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a></td></tr>
<tr class="memdesc:a6b570058188a424a4b4384391bad4fa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Explicit error code list :  <a href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">More...</a><br /></td></tr>
<tr class="separator:a6b570058188a424a4b4384391bad4fa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb961829d8cc8732bcbf5d7772601609"><td class="memItemLeft" align="right" valign="top">typedef short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#afb961829d8cc8732bcbf5d7772601609">T_AS5047_DIAG</a></td></tr>
<tr class="memdesc:afb961829d8cc8732bcbf5d7772601609"><td class="mdescLeft">&#160;</td><td class="mdescRight">Explicit diagnostic code list :  <a href="class_a_s5047.html#afb961829d8cc8732bcbf5d7772601609">More...</a><br /></td></tr>
<tr class="separator:afb961829d8cc8732bcbf5d7772601609"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79d8e25885df14ed4eaf48bbb73b9da6"><td class="memItemLeft" align="right" valign="top">typedef unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a79d8e25885df14ed4eaf48bbb73b9da6">T_AS5047_ADR</a></td></tr>
<tr class="memdesc:a79d8e25885df14ed4eaf48bbb73b9da6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Explicit registers address code list :  <a href="class_a_s5047.html#a79d8e25885df14ed4eaf48bbb73b9da6">More...</a><br /></td></tr>
<tr class="separator:a79d8e25885df14ed4eaf48bbb73b9da6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a71376318569683988afe849ca9dc3a9a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a71376318569683988afe849ca9dc3a9a">AS5047</a> (PinName mosi, PinName miso, PinName sck, PinName ss, int freq=1000000, bool invertBytesOrder=true)</td></tr>
<tr class="memdesc:a71376318569683988afe849ca9dc3a9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor of <a class="el" href="class_a_s5047.html" title="More informations at : https://ams.com/en/ams-start.">AS5047</a> object.  <a href="class_a_s5047.html#a71376318569683988afe849ca9dc3a9a">More...</a><br /></td></tr>
<tr class="separator:a71376318569683988afe849ca9dc3a9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d3c907e8c1928232dd1be89b704cc2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a67d3c907e8c1928232dd1be89b704cc2">~AS5047</a> ()</td></tr>
<tr class="separator:a67d3c907e8c1928232dd1be89b704cc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a360d9d4b9fae518f2f70d9ba5a4b6f24"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a360d9d4b9fae518f2f70d9ba5a4b6f24">setResolution</a> (short resolution)</td></tr>
<tr class="memdesc:a360d9d4b9fae518f2f70d9ba5a4b6f24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set how many step per turns are provided by the ABI interface of the sensor.  <a href="class_a_s5047.html#a360d9d4b9fae518f2f70d9ba5a4b6f24">More...</a><br /></td></tr>
<tr class="separator:a360d9d4b9fae518f2f70d9ba5a4b6f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a367e49a53c09fc607bd2aef4d637cbcb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a367e49a53c09fc607bd2aef4d637cbcb">getResolution</a> (short *resolution)</td></tr>
<tr class="memdesc:a367e49a53c09fc607bd2aef4d637cbcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">identify how many step per turns are provided by the ABI interface of the sensor.  <a href="class_a_s5047.html#a367e49a53c09fc607bd2aef4d637cbcb">More...</a><br /></td></tr>
<tr class="separator:a367e49a53c09fc607bd2aef4d637cbcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b5e7e8eb64da5261bdb3afe41d15f78"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a7b5e7e8eb64da5261bdb3afe41d15f78">diagnose</a> (<a class="el" href="class_a_s5047.html#afb961829d8cc8732bcbf5d7772601609">T_AS5047_DIAG</a> *diagValue)</td></tr>
<tr class="memdesc:a7b5e7e8eb64da5261bdb3afe41d15f78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identify the cause of an error when error flags are raised.  <a href="class_a_s5047.html#a7b5e7e8eb64da5261bdb3afe41d15f78">More...</a><br /></td></tr>
<tr class="separator:a7b5e7e8eb64da5261bdb3afe41d15f78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a9aeece3dd6f19903ce67a8dd3bf97a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a5a9aeece3dd6f19903ce67a8dd3bf97a">setUVWPairPoles</a> (short pairPoles)</td></tr>
<tr class="memdesc:a5a9aeece3dd6f19903ce67a8dd3bf97a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow the sensor to configurate the number of pair poles of a brushless motor between 1 and 8 pair poles.  <a href="class_a_s5047.html#a5a9aeece3dd6f19903ce67a8dd3bf97a">More...</a><br /></td></tr>
<tr class="separator:a5a9aeece3dd6f19903ce67a8dd3bf97a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90b9187c4a5a7e7076be1e468f17d276"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a90b9187c4a5a7e7076be1e468f17d276">ActivatePWM</a> (int port)</td></tr>
<tr class="memdesc:a90b9187c4a5a7e7076be1e468f17d276"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activate the PWM output on the selected pin (0 for W pin, 1 for I pin).  <a href="class_a_s5047.html#a90b9187c4a5a7e7076be1e468f17d276">More...</a><br /></td></tr>
<tr class="separator:a90b9187c4a5a7e7076be1e468f17d276"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaa05a736cc64d23205ea38bf731d3cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#abaa05a736cc64d23205ea38bf731d3cb">getDirection</a> (<a class="el" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399">T_AS5047_Rotation</a> *direction)</td></tr>
<tr class="memdesc:abaa05a736cc64d23205ea38bf731d3cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the direction of the rotation as a value :  <a href="class_a_s5047.html#abaa05a736cc64d23205ea38bf731d3cb">More...</a><br /></td></tr>
<tr class="separator:abaa05a736cc64d23205ea38bf731d3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e85eb5d591b59da9144f02afe0a4dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a59e85eb5d591b59da9144f02afe0a4dd">isAS5047Ready</a> (bool *ready)</td></tr>
<tr class="memdesc:a59e85eb5d591b59da9144f02afe0a4dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get readiness information about the convergence of the Kalman's filter of the sensor.  <a href="class_a_s5047.html#a59e85eb5d591b59da9144f02afe0a4dd">More...</a><br /></td></tr>
<tr class="separator:a59e85eb5d591b59da9144f02afe0a4dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af71443490b36ebe9d30f001eb68394e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#af71443490b36ebe9d30f001eb68394e8">getAngularPosition</a> (short *position)</td></tr>
<tr class="memdesc:af71443490b36ebe9d30f001eb68394e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the absolute angle position of the magnet relative to the sensor in 14 bits signed value.  <a href="class_a_s5047.html#af71443490b36ebe9d30f001eb68394e8">More...</a><br /></td></tr>
<tr class="separator:af71443490b36ebe9d30f001eb68394e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aa8c223a19f4f10e699852e0e87efdf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a4aa8c223a19f4f10e699852e0e87efdf">getDAECPosition</a> (short *position)</td></tr>
<tr class="memdesc:a4aa8c223a19f4f10e699852e0e87efdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the absolute angle with dynamic error compensation position of the magnet relative to the sensor in 14 bits signed value.  <a href="class_a_s5047.html#a4aa8c223a19f4f10e699852e0e87efdf">More...</a><br /></td></tr>
<tr class="separator:a4aa8c223a19f4f10e699852e0e87efdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b5a34cf5a91255b5c97980ff8c2f244"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a6b5a34cf5a91255b5c97980ff8c2f244">writeToSensor</a> (<a class="el" href="class_a_s5047.html#a79d8e25885df14ed4eaf48bbb73b9da6">T_AS5047_ADR</a> registerAddress, short registerValue)</td></tr>
<tr class="memdesc:a6b5a34cf5a91255b5c97980ff8c2f244"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a data value in a specific register of the sensor.  <a href="class_a_s5047.html#a6b5a34cf5a91255b5c97980ff8c2f244">More...</a><br /></td></tr>
<tr class="separator:a6b5a34cf5a91255b5c97980ff8c2f244"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51a44fb68ebf9e732e3620f4c3c6fa31"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#a51a44fb68ebf9e732e3620f4c3c6fa31">readFromSensor</a> (<a class="el" href="class_a_s5047.html#a79d8e25885df14ed4eaf48bbb73b9da6">T_AS5047_ADR</a> registerAddress, short *registerValue)</td></tr>
<tr class="memdesc:a51a44fb68ebf9e732e3620f4c3c6fa31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the data value of a specific register of the sensor.  <a href="class_a_s5047.html#a51a44fb68ebf9e732e3620f4c3c6fa31">More...</a><br /></td></tr>
<tr class="separator:a51a44fb68ebf9e732e3620f4c3c6fa31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ac07d9c36abf2d43f0681a540d7ed7a9b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_s5047.html#afb961829d8cc8732bcbf5d7772601609">T_AS5047_DIAG</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_s5047.html#ac07d9c36abf2d43f0681a540d7ed7a9b">AS5047_diagnostic</a></td></tr>
<tr class="memdesc:ac07d9c36abf2d43f0681a540d7ed7a9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">diagnostic value (see T_AS5047_DIAG for detail). Those value are automaticaly updated each time the Error Flag is set.  <a href="class_a_s5047.html#ac07d9c36abf2d43f0681a540d7ed7a9b">More...</a><br /></td></tr>
<tr class="separator:ac07d9c36abf2d43f0681a540d7ed7a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >More informations at : <a href="https://ams.com/en/ams-start">https://ams.com/en/ams-start</a>. </p>
<p ><a class="el" href="class_a_s5047.html" title="More informations at : https://ams.com/en/ams-start.">AS5047</a> is a Hall effect on axis angular position sensor widely used in motion control systems. This class is intended to configure the sensor and read the angular position using the SPI bus. No others communication interface are available in this library </p><dl class="section note"><dt>Note</dt><dd>All function are blocking (ie : function returns only when data have been received and/or order processed), to avoid being stuck, use watchdogs. </dd></dl>
<h1><a class="anchor" id="EXAMPLE"></a>
EXAMPLE</h1>
<p >The code below describe how to use a AS5047P sensor (without watchdogs).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;mbed.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_a_s5047_8h.html">AS5047.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define WAIT_TIME_MS 500</span></div>
<div class="line"> </div>
<div class="line">DigitalOut led1(LED1);</div>
<div class="line"><a class="code hl_class" href="class_a_s5047.html">AS5047</a> sensor (SPI_MOSI, SPI_MISO, SPI_SCK, PF_14, 10000000);</div>
<div class="line">Timer chronometer;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> errorHandling (<span class="keywordtype">int</span>* errorCount);</div>
<div class="line"><span class="keywordtype">long</span> incrementalAngleHandling (<span class="keywordtype">short</span> angle, <a class="code hl_enumeration" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399">AS5047::T_AS5047_Rotation</a> direction);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">bool</span> ready;</div>
<div class="line">    <span class="keywordtype">int</span>  errorCount = 0;</div>
<div class="line">    <a class="code hl_typedef" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">AS5047::T_AS5047_Error</a> cr;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">long</span> angularPosition = 0;   <span class="comment">// &quot;long&quot; is suitable for less than 131 072 turn else choose &quot;long long&quot;. Avoid floating point numbers.</span></div>
<div class="line">    <span class="keywordtype">short</span> angle;</div>
<div class="line">    <a class="code hl_enumeration" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399">AS5047::T_AS5047_Rotation</a> direction;</div>
<div class="line">    </div>
<div class="line">    Watchdog &amp;theDog = Watchdog::get_instance();</div>
<div class="line">    theDog.start(10000);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;This is the bare metal blinky example running on Mbed OS %d.%d.%d.\n&quot;</span>, MBED_MAJOR_VERSION, MBED_MINOR_VERSION, MBED_PATCH_VERSION);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        cr = sensor.isAS5047Ready(&amp;ready);</div>
<div class="line">    } <span class="keywordflow">while</span> ((cr != 0) || (!ready));</div>
<div class="line"> </div>
<div class="line">    chronometer.start();</div>
<div class="line">    chronometer.reset();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line">    {</div>
<div class="line">      theDog.kick();</div>
<div class="line">      <span class="keywordflow">while</span> (chronometer.elapsed_time().count() &lt; 1000); <span class="comment">// 1ms wait between update</span></div>
<div class="line">      chronometer.reset();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (errorCount &gt; 0) errorCount--;</div>
<div class="line"> </div>
<div class="line">      cr = sensor.getAngularPosition(&amp;angle); <span class="comment">// get angle</span></div>
<div class="line">      <span class="keywordflow">if</span> (cr != <a class="code hl_define" href="_a_s5047_8h.html#a63cba29e2251a578b2207fbb2f71d407">AS5047_ERR_OK</a>) errorHandling(&amp;errorCount);</div>
<div class="line"> </div>
<div class="line">      cr = sensor.getDirection(&amp;direction); <span class="comment">// get direction</span></div>
<div class="line">      <span class="keywordflow">if</span> (cr != <a class="code hl_define" href="_a_s5047_8h.html#a63cba29e2251a578b2207fbb2f71d407">AS5047_ERR_OK</a>) errorHandling(&amp;errorCount);</div>
<div class="line"> </div>
<div class="line">      angularPosition += incrementalAngleHandling(angle, direction);</div>
<div class="line"> </div>
<div class="line">      printf(<span class="stringliteral">&quot;%ld\n&quot;</span>, angularPosition);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Recursive error handling function</span></div>
<div class="line"><span class="keywordtype">void</span> errorHandling (<span class="keywordtype">int</span>* errorCount){</div>
<div class="line">    <a class="code hl_typedef" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">AS5047::T_AS5047_Error</a> cr;</div>
<div class="line">    <span class="keywordtype">short</span> diagValue;</div>
<div class="line"> </div>
<div class="line">    *errorCount += 1;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (*errorCount &gt; 20) {</div>
<div class="line">        printf (<span class="stringliteral">&quot;Too many errors - Aborting\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">while</span> (<span class="keyword">true</span>) {thread_sleep_for(WAIT_TIME_MS);}</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        cr = sensor.diagnose(&amp;diagValue);</div>
<div class="line">        <span class="keywordflow">if</span> (cr != 0) errorHandling(errorCount);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">long</span> incrementalAngleHandling (<span class="keywordtype">short</span> angle, <a class="code hl_enumeration" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399">AS5047::T_AS5047_Rotation</a> direction){</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">long</span> lastAngle = 0;</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">bool</span> firstTime = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">long</span> diffAngle;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (firstTime){</div>
<div class="line">        lastAngle = angle;</div>
<div class="line">        diffAngle = 0;</div>
<div class="line">        firstTime = <span class="keyword">false</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">if</span> ((direction == <a class="code hl_enumvalue" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399afb41fbae1a0e478416cb6ca7e7d42894">AS5047::CW_increasing</a>) &amp;&amp; (angle &lt; lastAngle)) angle = angle + 16384;</div>
<div class="line">        <span class="keywordflow">if</span> ((direction == <a class="code hl_enumvalue" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399a87b06a79ccea20d744ca45444038baac">AS5047::CCW_decreasing</a>) &amp;&amp; (angle &gt; lastAngle)) angle = angle - 16384;</div>
<div class="line">        lastAngle = (long)angle;</div>
<div class="line">        diffAngle = (long)angle - lastAngle;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> diffAngle;</div>
<div class="line">}</div>
<div class="ttc" id="a_a_s5047_8h_html"><div class="ttname"><a href="_a_s5047_8h.html">AS5047.h</a></div><div class="ttdoc">Header file containing the AS5047 class compatible with mbed-os 6 (baremetal or multithread) using SP...</div></div>
<div class="ttc" id="a_a_s5047_8h_html_a63cba29e2251a578b2207fbb2f71d407"><div class="ttname"><a href="_a_s5047_8h.html#a63cba29e2251a578b2207fbb2f71d407">AS5047_ERR_OK</a></div><div class="ttdeci">#define AS5047_ERR_OK</div><div class="ttdef"><b>Definition:</b> <a href="_a_s5047_8h_source.html#l00064">AS5047.h:64</a></div></div>
<div class="ttc" id="aclass_a_s5047_html"><div class="ttname"><a href="class_a_s5047.html">AS5047</a></div><div class="ttdoc">More informations at : https://ams.com/en/ams-start.</div><div class="ttdef"><b>Definition:</b> <a href="_a_s5047_8h_source.html#l00083">AS5047.h:83</a></div></div>
<div class="ttc" id="aclass_a_s5047_html_a404f74b69362df86e4a2509c4600d399"><div class="ttname"><a href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399">AS5047::T_AS5047_Rotation</a></div><div class="ttdeci">T_AS5047_Rotation</div><div class="ttdoc">Explicit information list :</div><div class="ttdef"><b>Definition:</b> <a href="_a_s5047_8h_source.html#l00207">AS5047.h:207</a></div></div>
<div class="ttc" id="aclass_a_s5047_html_a404f74b69362df86e4a2509c4600d399a87b06a79ccea20d744ca45444038baac"><div class="ttname"><a href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399a87b06a79ccea20d744ca45444038baac">AS5047::CCW_decreasing</a></div><div class="ttdeci">@ CCW_decreasing</div><div class="ttdef"><b>Definition:</b> <a href="_a_s5047_8h_source.html#l00210">AS5047.h:209</a></div></div>
<div class="ttc" id="aclass_a_s5047_html_a404f74b69362df86e4a2509c4600d399afb41fbae1a0e478416cb6ca7e7d42894"><div class="ttname"><a href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399afb41fbae1a0e478416cb6ca7e7d42894">AS5047::CW_increasing</a></div><div class="ttdeci">@ CW_increasing</div><div class="ttdef"><b>Definition:</b> <a href="_a_s5047_8h_source.html#l00208">AS5047.h:208</a></div></div>
<div class="ttc" id="aclass_a_s5047_html_a6b570058188a424a4b4384391bad4fa7"><div class="ttname"><a href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">AS5047::T_AS5047_Error</a></div><div class="ttdeci">short T_AS5047_Error</div><div class="ttdoc">Explicit error code list :</div><div class="ttdef"><b>Definition:</b> <a href="_a_s5047_8h_source.html#l00225">AS5047.h:225</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="_a_s5047_8h_source.html#l00083">83</a> of file <a class="el" href="_a_s5047_8h_source.html">AS5047.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a79d8e25885df14ed4eaf48bbb73b9da6" name="a79d8e25885df14ed4eaf48bbb73b9da6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79d8e25885df14ed4eaf48bbb73b9da6">&#9670;&#160;</a></span>T_AS5047_ADR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef unsigned short <a class="el" href="class_a_s5047.html#a79d8e25885df14ed4eaf48bbb73b9da6">AS5047::T_AS5047_ADR</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Explicit registers address code list : </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">AS5047_ADR_NOP</td><td>= 0x0000 : No Operation Register - Read Only </td></tr>
    <tr><td class="paramname">AS5047_ADR_ERRFL</td><td>= 0x0001 : Error Flag Register - Read Only </td></tr>
    <tr><td class="paramname">AS5047_ADR_PROG</td><td>= 0x0003 : Programming Register - Read/Write </td></tr>
    <tr><td class="paramname">AS5047_ADR_ZPOSM</td><td>= 0x0016 : Zero Position MSB Register - Read/Write/Program </td></tr>
    <tr><td class="paramname">AS5047_ADR_ZPOSL</td><td>= 0x0017 : Zero Position LSB Register - Read/Write/Program </td></tr>
    <tr><td class="paramname">AS5047_ADR_SETTING1</td><td>= 0x0018 : #1 Setting Register - Read/Write/Program </td></tr>
    <tr><td class="paramname">AS5047_ADR_SETTING2</td><td>= 0x0019 : #2 Setting Register - Read/Write/Program </td></tr>
    <tr><td class="paramname">AS5047_ADR_DIAAGC</td><td>= 0x3FFC : Diagnostic &amp; Automatic Gain control Register - Read Only </td></tr>
    <tr><td class="paramname">AS5047_ADR_MAG</td><td>= 0x3FFD : Magnetic Field value Register - Read Only </td></tr>
    <tr><td class="paramname">AS5047_ADR_ANGLE</td><td>= 0x3FFE : Raw Angle value Register - Read Only </td></tr>
    <tr><td class="paramname">AS5047_ADR_ANGLECOM</td><td>= 0x3FFF : DAE Compensated Angle value Register - Read Only </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The <a class="el" href="class_a_s5047.html" title="More informations at : https://ams.com/en/ams-start.">AS5047</a> has a OTP (one time programming) memory, therefore programming has not been implemented. Writing in those register stores data in a non volatile memory (that remains until shutdown). </dd></dl>

<p class="definition">Definition at line <a class="el" href="_a_s5047_8h_source.html#l00259">259</a> of file <a class="el" href="_a_s5047_8h_source.html">AS5047.h</a>.</p>

</div>
</div>
<a id="afb961829d8cc8732bcbf5d7772601609" name="afb961829d8cc8732bcbf5d7772601609"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb961829d8cc8732bcbf5d7772601609">&#9670;&#160;</a></span>T_AS5047_DIAG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef short <a class="el" href="class_a_s5047.html#afb961829d8cc8732bcbf5d7772601609">AS5047::T_AS5047_DIAG</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Explicit diagnostic code list : </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">AS5047_DIAG_OK</td><td>= 0 : OK - No error </td></tr>
    <tr><td class="paramname">AS5047_DIAG_PARITY</td><td>= 1 : Parity Error - The parity computed by the sensor is different of the one in the frame it received </td></tr>
    <tr><td class="paramname">AS5047_DIAG_INVCOMM</td><td>= 2 : Invalid command - The command address is not valid </td></tr>
    <tr><td class="paramname">AS5047_DIAG_FRAME</td><td>= 4 : Frame Error - The frame received is not a valid SPI frame </td></tr>
    <tr><td class="paramname">AS5047_DIAG_MAGL</td><td>= 8 : Magnetic error - The magnetic field is too low and sensor is not able to give a reliable position vector </td></tr>
    <tr><td class="paramname">AS5047_DIAG_MAGH</td><td>= 16 : Magnetic error - The magnetic field is too strong and sensor is not able to give a reliable position vector </td></tr>
    <tr><td class="paramname">AS5047_DIAG_CORDIC</td><td>= 32 : CORDIC Error - The coordinate rotating digital computer is experiencing an overflow and sensor is not able to give a reliable position vector </td></tr>
    <tr><td class="paramname">AS5047_DIAG_NOT_READY</td><td>= 64 : NOT READY - The offset compensation loop hasn't finish converging and sensor is giving an unaccurate position vector </td></tr>
    <tr><td class="paramname">AS5047_DIAG_FAIL</td><td>= 128 : Diagnostic frame error - The diagnostic frame was erroneous </td></tr>
    <tr><td class="paramname">AS5047_DIAG_ERR_FAIL</td><td>= 256 : Error Flag Frame Error - The error flag frame was erroneous </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The value obtained is the sum of all detected errors (for example if there is a NOT READY and a MAGH, value will be 80 (= 16 + 64)) </dd>
<dd>
The value of diagnostic is obtained by a sensor interrogation and list errors d√©tected by the sensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_a_s5047_8h_source.html#l00242">242</a> of file <a class="el" href="_a_s5047_8h_source.html">AS5047.h</a>.</p>

</div>
</div>
<a id="a6b570058188a424a4b4384391bad4fa7" name="a6b570058188a424a4b4384391bad4fa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b570058188a424a4b4384391bad4fa7">&#9670;&#160;</a></span>T_AS5047_Error</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef short <a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">AS5047::T_AS5047_Error</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Explicit error code list : </p>
<p >Error(s) are detected by the functions and indicate a problem coming from code execution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">AS5047_ERR_OK</td><td>= 0 : OK - No error </td></tr>
    <tr><td class="paramname">AS5047_ERR_PARITY</td><td>= 1 : Parity Error - parity compute by the function is not the one present in the received frame </td></tr>
    <tr><td class="paramname">AS5047_ERR_FLAG</td><td>= 2 : Error Flag - The sensor has detected a problem with the last frame he has received or is experiencing a malfunction. </td></tr>
    <tr><td class="paramname">AS5047_ERR_ADDRESS</td><td>= 4 : Address Error - Address given to the function is not a valid register address </td></tr>
    <tr><td class="paramname">AS5047_ERR_DATA</td><td>= 8 : Data Error - Data given to the function is not of the good format </td></tr>
    <tr><td class="paramname">AS5047_ERR_PARAM</td><td>= 16 : Parameter Error - The parameter given to the function is not valid </td></tr>
    <tr><td class="paramname">AS5047_ERR_WRITE</td><td>= 32 : Write Order Fail - The write command fail to change the value of the register </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The error value is the sum of all error detected (for example if there is a parity error and the error flag is raised, return code will be 3 (= 1 + 2)) ERROR_FLAG is a flag set by the sensor to indicate a problem (see diagnostic section). </dd></dl>

<p class="definition">Definition at line <a class="el" href="_a_s5047_8h_source.html#l00225">225</a> of file <a class="el" href="_a_s5047_8h_source.html">AS5047.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a404f74b69362df86e4a2509c4600d399" name="a404f74b69362df86e4a2509c4600d399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404f74b69362df86e4a2509c4600d399">&#9670;&#160;</a></span>T_AS5047_Rotation</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399">AS5047::T_AS5047_Rotation</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Explicit information list : </p>
<p >Easy to use type to identify rotation direction. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CW_increasing</td><td>= 0 : magnet is turning Clockwise (ie : angle value is increasing) </td></tr>
    <tr><td class="paramname">CCW_decreasing</td><td>= 1 : magnet is turning Counterclockwise (ie : angle value is decreasing) </td></tr>
  </table>
  </dd>
</dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a404f74b69362df86e4a2509c4600d399afb41fbae1a0e478416cb6ca7e7d42894" name="a404f74b69362df86e4a2509c4600d399afb41fbae1a0e478416cb6ca7e7d42894"></a>CW_increasing&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a404f74b69362df86e4a2509c4600d399a87b06a79ccea20d744ca45444038baac" name="a404f74b69362df86e4a2509c4600d399a87b06a79ccea20d744ca45444038baac"></a>CCW_decreasing&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="_a_s5047_8h_source.html#l00207">207</a> of file <a class="el" href="_a_s5047_8h_source.html">AS5047.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a71376318569683988afe849ca9dc3a9a" name="a71376318569683988afe849ca9dc3a9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71376318569683988afe849ca9dc3a9a">&#9670;&#160;</a></span>AS5047()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AS5047::AS5047 </td>
          <td>(</td>
          <td class="paramtype">PinName&#160;</td>
          <td class="paramname"><em>mosi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PinName&#160;</td>
          <td class="paramname"><em>miso</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PinName&#160;</td>
          <td class="paramname"><em>sck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PinName&#160;</td>
          <td class="paramname"><em>ss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>freq</em> = <code>1000000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>invertBytesOrder</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor of <a class="el" href="class_a_s5047.html" title="More informations at : https://ams.com/en/ams-start.">AS5047</a> object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mosi</td><td>: the Mbed pin used as MOSI (Master Out - Slave In) </td></tr>
    <tr><td class="paramname">miso</td><td>: the Mbed pin used as MISO (Master In - Slave Out) </td></tr>
    <tr><td class="paramname">sck</td><td>: the Mbed pin used as SCK (serial clock) </td></tr>
    <tr><td class="paramname">ss</td><td>: the Mbed pin used as SS (Slave Select) </td></tr>
    <tr><td class="paramname">freq</td><td>: the serial clock frequency (default is 1MHz or 1Mbits/s) </td></tr>
    <tr><td class="paramname">invertBytesOrder</td><td>: swap the lower and upper byte (default is Yes) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The SS pin can be any digital output and has no obligation of being hardware associated with the SPI bus </dd>
<dd>
We used the 8 bit SPI mode (because 16 bit doesn't look functionnal), so, we need to swap bytes :<ul>
<li>SPI bus is configured in Big Endian (bits are transmitted in the order : MSB to LSB).</li>
<li>ARM is Little Endian so it sends word's bytes from LSB to MSB (LSB is sent first).</li>
<li>So a 16 bits word is sent : bit 7 - ... - bit 0 (first byte), then : bit 15 - ... - bit 8 (second byte)</li>
<li><a class="el" href="class_a_s5047.html" title="More informations at : https://ams.com/en/ams-start.">AS5047</a> SPI interface requires bits sent msb first. So we need to swap bytes before transmition and after reception.</li>
<li>You may change invertBytesOrder to false, if you use 16 bits SPI mode. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a67d3c907e8c1928232dd1be89b704cc2" name="a67d3c907e8c1928232dd1be89b704cc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d3c907e8c1928232dd1be89b704cc2">&#9670;&#160;</a></span>~AS5047()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AS5047::~AS5047 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Destructor of <a class="el" href="class_a_s5047.html" title="More informations at : https://ams.com/en/ams-start.">AS5047</a> object. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a90b9187c4a5a7e7076be1e468f17d276" name="a90b9187c4a5a7e7076be1e468f17d276"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90b9187c4a5a7e7076be1e468f17d276">&#9670;&#160;</a></span>ActivatePWM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::ActivatePWM </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>port</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Activate the PWM output on the selected pin (0 for W pin, 1 for I pin). </p>
<dl class="section note"><dt>Note</dt><dd>The PWM signal is based on a 444 ns clock with a period of 4119 clock cycle (12 + 4 + 4095 + 8 period of the clock). The signal is composed of 12 periods high, followed by 4 periods low and then between 0 and 4095 period for the angular position, and then 8 periods low. </dd>
<dd>
More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td>(int, passed by value) : selected output pin (0 for W pin used as PWM output, 1 for I pin used as PWM output). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Depending on the selected output pin, it diasble UVW or ABI output (0 will disable the UVW output function, 1 will disable the ABI output function). </dd></dl>

</div>
</div>
<a id="a7b5e7e8eb64da5261bdb3afe41d15f78" name="a7b5e7e8eb64da5261bdb3afe41d15f78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b5e7e8eb64da5261bdb3afe41d15f78">&#9670;&#160;</a></span>diagnose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::diagnose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_a_s5047.html#afb961829d8cc8732bcbf5d7772601609">T_AS5047_DIAG</a> *&#160;</td>
          <td class="paramname"><em>diagValue</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identify the cause of an error when error flags are raised. </p>
<dl class="section note"><dt>Note</dt><dd>Possible returned value is the sum of :<ul>
<li>0 : No error detected</li>
<li>1 : Parity error - The parity bit in the frame is not the same that the one that has been computed.</li>
<li>2 : Invalid command - The last command has not been understood by the sensor.</li>
<li>4 : Invalid frame - The frame does not correspond to sensor's SPI format.</li>
<li>8 : Magnetic field too low - The magnetic field is too low to get a good angular position.</li>
<li>16 : Magnetic field too high - The magnetic field is too high to get a good angular position.</li>
<li>32 : CORDIC error - The sensor coordinate computer has failed to compute an accurate position.</li>
<li>64 : Not ready - The sensor is not ready.</li>
<li>128 : DIAG Error - The reading of DIAG frame has failed</li>
<li>256 : Error Flag Error - The reading of the Error Flag has failed </li>
</ul>
</dd>
<dd>
More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">diagValue</td><td>(T_AS5047_DIAG, passed by address) : sum of active codes - Not mandatory (one may use the global variable : AS5047_diagnostic) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>

</div>
</div>
<a id="af71443490b36ebe9d30f001eb68394e8" name="af71443490b36ebe9d30f001eb68394e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af71443490b36ebe9d30f001eb68394e8">&#9670;&#160;</a></span>getAngularPosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::getAngularPosition </td>
          <td>(</td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>position</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the absolute angle position of the magnet relative to the sensor in 14 bits signed value. </p>
<dl class="section note"><dt>Note</dt><dd>More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">position</td><td>(short, passed by address) : 14 bits angle value (from -8192 up to 8192). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>

</div>
</div>
<a id="a4aa8c223a19f4f10e699852e0e87efdf" name="a4aa8c223a19f4f10e699852e0e87efdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aa8c223a19f4f10e699852e0e87efdf">&#9670;&#160;</a></span>getDAECPosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::getDAECPosition </td>
          <td>(</td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>position</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the absolute angle with dynamic error compensation position of the magnet relative to the sensor in 14 bits signed value. </p>
<dl class="section note"><dt>Note</dt><dd>Position returned by this method is not suitable in most case (only constant rotation speed can bring to a valid result) <br  />
 </dd>
<dd>
More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">position</td><td>(short, passed by address) : 14 bits angle value (from -8192 up to 8192). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>

</div>
</div>
<a id="abaa05a736cc64d23205ea38bf731d3cb" name="abaa05a736cc64d23205ea38bf731d3cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaa05a736cc64d23205ea38bf731d3cb">&#9670;&#160;</a></span>getDirection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::getDirection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_a_s5047.html#a404f74b69362df86e4a2509c4600d399">T_AS5047_Rotation</a> *&#160;</td>
          <td class="paramname"><em>direction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the direction of the rotation as a value : </p>
<ul>
<li>CW_increasing = 0 : clockwise - angle is increasing,</li>
<li>CCW_decreasing = 1 : counterclockwise - angle is decreasing. <dl class="section note"><dt>Note</dt><dd>Direction is the instant value of the spinning direction. As position value is absolute (not incremental), you may use this function for both overflow or underflow of the position - ie : when position reach one of the limits of the span (-8192 to 8191) - or any other reason. <br  />
 </dd>
<dd>
More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">direction</td><td>(int, passed by address) : spinning direction when the order has been processed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>
</li>
</ul>

</div>
</div>
<a id="a367e49a53c09fc607bd2aef4d637cbcb" name="a367e49a53c09fc607bd2aef4d637cbcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a367e49a53c09fc607bd2aef4d637cbcb">&#9670;&#160;</a></span>getResolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::getResolution </td>
          <td>(</td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>resolution</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>identify how many step per turns are provided by the ABI interface of the sensor. </p>
<dl class="section note"><dt>Note</dt><dd>Possible return values are :<ul>
<li>4096 (4096 steps/turn or 1024 pulse/channel/turn)</li>
<li>4000 (4000 steps/turn or 1000 pulse/channel/turn)</li>
<li>2048 (2048 steps/turn or 512 pulse/channel/turn)</li>
<li>2000 (2000 steps/turn or 500 pulse/channel/turn)</li>
<li>1600 (1600 steps/turn or 400 pulse/channel/turn)</li>
<li>1200 (1200 steps/turn or 300 pulse/channel/turn)</li>
<li>1024 (1024 steps/turn or 256 pulse/channel/turn)</li>
<li>800 ( 800 steps/turn or 200 pulse/channel/turn)</li>
<li>400 ( 400 steps/turn or 100 pulse/channel/turn)</li>
<li>200 ( 200 steps/turn or 50 pulse/channel/turn)</li>
<li>100 ( 100 steps/turn or 25 pulse/channel/turn) </li>
</ul>
</dd>
<dd>
More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resolution</td><td>(short, passed by address) : resolution of the sensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>

</div>
</div>
<a id="a59e85eb5d591b59da9144f02afe0a4dd" name="a59e85eb5d591b59da9144f02afe0a4dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59e85eb5d591b59da9144f02afe0a4dd">&#9670;&#160;</a></span>isAS5047Ready()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::isAS5047Ready </td>
          <td>(</td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>ready</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get readiness information about the convergence of the Kalman's filter of the sensor. </p>
<dl class="section note"><dt>Note</dt><dd>More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ready</td><td>(boolean, passed by address) : true when calibration algorithm has converged, false otherwise. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>

</div>
</div>
<a id="a51a44fb68ebf9e732e3620f4c3c6fa31" name="a51a44fb68ebf9e732e3620f4c3c6fa31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51a44fb68ebf9e732e3620f4c3c6fa31">&#9670;&#160;</a></span>readFromSensor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::readFromSensor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_a_s5047.html#a79d8e25885df14ed4eaf48bbb73b9da6">T_AS5047_ADR</a>&#160;</td>
          <td class="paramname"><em>registerAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>registerValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the data value of a specific register of the sensor. </p>
<dl class="section note"><dt>Note</dt><dd>More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">registerAddress</td><td>(T_AS5047_ADR, passed by value) : 14 bits register address value. </td></tr>
    <tr><td class="paramname">registerValue</td><td>(short, passed by address) : 14 bits register data value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>

</div>
</div>
<a id="a360d9d4b9fae518f2f70d9ba5a4b6f24" name="a360d9d4b9fae518f2f70d9ba5a4b6f24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a360d9d4b9fae518f2f70d9ba5a4b6f24">&#9670;&#160;</a></span>setResolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::setResolution </td>
          <td>(</td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>resolution</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set how many step per turns are provided by the ABI interface of the sensor. </p>
<dl class="section note"><dt>Note</dt><dd>Possible values for resolution are :<ul>
<li>4096 (4096 steps/turn or 1024 pulse/channel/turn)</li>
<li>4000 (4000 steps/turn or 1000 pulse/channel/turn)</li>
<li>2048 (2048 steps/turn or 512 pulse/channel/turn)</li>
<li>2000 (2000 steps/turn or 500 pulse/channel/turn)</li>
<li>1600 (1600 steps/turn or 400 pulse/channel/turn)</li>
<li>1200 (1200 steps/turn or 300 pulse/channel/turn)</li>
<li>1024 (1024 steps/turn or 256 pulse/channel/turn)</li>
<li>800 ( 800 steps/turn or 200 pulse/channel/turn)</li>
<li>400 ( 400 steps/turn or 100 pulse/channel/turn)</li>
<li>200 ( 200 steps/turn or 50 pulse/channel/turn)</li>
<li>100 ( 100 steps/turn or 25 pulse/channel/turn) </li>
</ul>
</dd>
<dd>
More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resolution</td><td>(short, passed by value) : resolution of the sensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Invalid resolution command will return a AS5047_ERR_PARAM error. </dd></dl>

</div>
</div>
<a id="a5a9aeece3dd6f19903ce67a8dd3bf97a" name="a5a9aeece3dd6f19903ce67a8dd3bf97a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a9aeece3dd6f19903ce67a8dd3bf97a">&#9670;&#160;</a></span>setUVWPairPoles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::setUVWPairPoles </td>
          <td>(</td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>pairPoles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allow the sensor to configurate the number of pair poles of a brushless motor between 1 and 8 pair poles. </p>
<dl class="section note"><dt>Note</dt><dd>The number of pair poles is dependent of the motor, it should be configured to allow the sensor to replace classical Hall Sensors and configured to allow the motor driver to work accordingly with the motor. The number of pair poles is the given value plus one and the number of poles is twice the number of pair poles. So setting pairPoles to 0 means 1 pair pole (or 2 poles), setting it to 4 means 5 pair poles (or 10 poles). </dd>
<dd>
More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pairPoles</td><td>(short, passed by value) : number of pair poles minus 1 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>

</div>
</div>
<a id="a6b5a34cf5a91255b5c97980ff8c2f244" name="a6b5a34cf5a91255b5c97980ff8c2f244"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b5a34cf5a91255b5c97980ff8c2f244">&#9670;&#160;</a></span>writeToSensor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#a6b570058188a424a4b4384391bad4fa7">T_AS5047_Error</a> AS5047::writeToSensor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_a_s5047.html#a79d8e25885df14ed4eaf48bbb73b9da6">T_AS5047_ADR</a>&#160;</td>
          <td class="paramname"><em>registerAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>registerValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a data value in a specific register of the sensor. </p>
<dl class="section note"><dt>Note</dt><dd>More informations at : <a href="https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf">https://ams.com/documents/20143/36005/AS5047P_DS000324_3-00.pdf</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">registerAddress</td><td>(T_AS5047_ADR, passed by value) : 14 bits register address value. </td></tr>
    <tr><td class="paramname">registerValue</td><td>(short, passed by value) : 14 bits register data value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>T_AS5047_Error : error code. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac07d9c36abf2d43f0681a540d7ed7a9b" name="ac07d9c36abf2d43f0681a540d7ed7a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac07d9c36abf2d43f0681a540d7ed7a9b">&#9670;&#160;</a></span>AS5047_diagnostic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_s5047.html#afb961829d8cc8732bcbf5d7772601609">T_AS5047_DIAG</a> AS5047::AS5047_diagnostic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>diagnostic value (see T_AS5047_DIAG for detail). Those value are automaticaly updated each time the Error Flag is set. </p>

<p class="definition">Definition at line <a class="el" href="_a_s5047_8h_source.html#l00267">267</a> of file <a class="el" href="_a_s5047_8h_source.html">AS5047.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>AS5047/<a class="el" href="_a_s5047_8h_source.html">AS5047.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_a_s5047.html">AS5047</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
